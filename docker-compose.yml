version: '3.8'

services:
  # ===== API Services =====

  osint:
    build: ./services/osint
    container_name: aegis-osint
    ports:
      - "8000:8000"
    restart: unless-stopped
    environment:
      - PYTHONUNBUFFERED=1
      - SHODAN_API_KEY=${SHODAN_API_KEY:-}
      - SPIDERFOOT_URL=http://spiderfoot:5001

  spiderfoot:
    build:
      context: ./services/spiderfoot
      dockerfile: Dockerfile
    container_name: aegis-spiderfoot
    ports:
      - "5001:5001"
    restart: unless-stopped

  ai-protect:
    build: ./services/ai-protect
    container_name: aegis-ai-protect
    ports:
      - "8010:8010"
    restart: unless-stopped
    volumes:
      - ./data/ai-protect:/app/data
    environment:
      - PYTHONUNBUFFERED=1

  voice-protect:
    build: ./services/voice-protect
    container_name: aegis-voice-protect
    ports:
      - "8020:8020"
    restart: unless-stopped
    volumes:
      - ./data/voice-protect:/app/data
    environment:
      - PYTHONUNBUFFERED=1

  soc-core:
    build: ./services/soc-core
    container_name: aegis-soc-core
    ports:
      - "8030:8030"
    restart: unless-stopped
    volumes:
      - ./data/soc:/app/data
    environment:
      - PYTHONUNBUFFERED=1

  # ===== Dashboards =====

  osint-dashboard:
    build: ./dashboards/osint-dashboard
    container_name: aegis-osint-dashboard
    ports:
      - "8200:80"
    restart: unless-stopped

  shodan-dashboard:
    build: ./dashboards/shodan-dashboard
    container_name: aegis-shodan-dashboard
    ports:
      - "8201:80"
    restart: unless-stopped

  ai-protect-dashboard:
    build: ./dashboards/ai-protect-dashboard
    container_name: aegis-ai-dashboard
    ports:
      - "8210:80"
    restart: unless-stopped

  voice-protect-dashboard:
    build: ./dashboards/voice-protect-dashboard
    container_name: aegis-voice-dashboard
    ports:
      - "8220:80"
    restart: unless-stopped

  soc-dashboard:
    build: ./dashboards/soc-dashboard
    container_name: aegis-soc-dashboard
    ports:
      - "8230:80"
    restart: unless-stopped

volumes:
  data:
